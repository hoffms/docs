"use strict";(self.webpackChunk_uniswap_docs=self.webpackChunk_uniswap_docs||[]).push([[5232],{5051:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var n=r(83117),i=(r(67294),r(3905));const a={id:"v1vsv2",title:"UniswapX V2",sidebar_position:2},o="**UniswapX V2 Overview**",s={unversionedId:"contracts/uniswapx/v1vsv2",id:"contracts/uniswapx/v1vsv2",title:"UniswapX V2",description:"UniswapX V2 improves price execution and minimizes quoter gaming by redesigning the flow of order quote information. The primary goal is to make trading on UniswapX more efficient and more reliable.",source:"@site/docs/contracts/uniswapx/02-v1-vs-v2.md",sourceDirName:"contracts/uniswapx",slug:"/contracts/uniswapx/v1vsv2",permalink:"/docs/contracts/uniswapx/v1vsv2",editUrl:"https://github.com/uniswap/uniswap-docs/tree/main/docs/contracts/uniswapx/02-v1-vs-v2.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"v1vsv2",title:"UniswapX V2",sidebar_position:2},sidebar:"contractsSidebar",previous:{title:"Overview",permalink:"/docs/contracts/uniswapx/overview"},next:{title:"Filling on Mainnet",permalink:"/docs/contracts/uniswapx/guides/mainnet/createfiller"}},c={},l=[{value:"<strong>V1 Overview</strong>",id:"v1-overview",level:2},{value:"<strong>V2 Overview</strong>",id:"v2-overview",level:2},{value:"V2 Flow",id:"v2-flow",level:2},{value:"Why is a cosigner needed?",id:"why-is-a-cosigner-needed",level:2}],u={toc:l};function p(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"uniswapx-v2-overview"},(0,i.kt)("strong",{parentName:"h1"},"UniswapX V2 Overview")),(0,i.kt)("p",null,"UniswapX V2 improves price execution and minimizes quoter gaming by redesigning the flow of order quote information. The primary goal is to make trading on UniswapX more efficient and more reliable. "),(0,i.kt)("h2",{id:"v1-overview"},(0,i.kt)("strong",{parentName:"h2"},"V1 Overview")),(0,i.kt)("p",null,"In V1, the RFQ flow operates entirely pre-signature. Users request a swap quote, which is parameterized using an RFQ quote. If they accept the quote, they sign the order. This approach is straightforward but causes quoters in the network to be uncertain about when a quote request will convert into a signed order. This uncertainty leads to occasional unfilled orders and degraded performance."),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"599",alt:"image",src:r(31148).Z})),(0,i.kt)("h2",{id:"v2-overview"},(0,i.kt)("strong",{parentName:"h2"},"V2 Overview")),(0,i.kt)("p",null,"V2 rearchitects the flow such that the time between a quoter submitting their quote and being required to fill the order is minimized. This enforces a near 100% fill rate and causes most orders to fill almost instantly."),(0,i.kt)("p",null,"To achieve this, the quoting flow is divided into two phases:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Indicative Quotes"),": Provided pre-signature when the swapper is exploring quotes but has not committed to trading. Quoters can participate here without being held fully accountable.  "),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Hard Quotes"),": Provided post-signature when the swapper has committed to trading. Quoters are held fully accountable for these quotes.")),(0,i.kt)("p",null,"Since hard quotes are provided post-signature, they are instantly executable by fillers removing the risk of market movements causing the order to fail."),(0,i.kt)("p",null,"To prevent gaming, quoters cannot distinguish between indicative and hard quotes. As a result, they must always assume all quotes are hard and provide competitive prices."),(0,i.kt)("h2",{id:"v2-flow"},"V2 Flow"),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"599",alt:"image",src:r(5379).Z})),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"The user requests a quote from the interface.  "),(0,i.kt)("li",{parentName:"ol"},"The Uniswap Backend (URA) runs an indicative RFQ auction, soliciting quotes for the best price. (",(0,i.kt)("strong",{parentName:"li"},"Note:")," Quoters do not know whether the RFQ is indicative or hard, forcing them to always provide competitive prices.)"),(0,i.kt)("li",{parentName:"ol"},"The quotes from the RFQ process parameterize an ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/Uniswap/UniswapX/blob/33fa564cfaa6d58f6e3fcf7e7988cb5fc1c61de7/src/lib/V2DutchOrderLib.sol#L31"},"initial quote")," order shown to the user.  "),(0,i.kt)("li",{parentName:"ol"},"The user signs the order and submits it for execution.  "),(0,i.kt)("li",{parentName:"ol"},"The Uniswap Backend (GPA) runs a second \u201chard\u201d RFQ process, soliciting new quotes.  "),(0,i.kt)("li",{parentName:"ol"},"Quoters return their best prices again.  ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"If the price is within or improves on the user\u2019s signed parameters, it is finalized and added to the order\u2019s ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/Uniswap/UniswapX/blob/33fa564cfaa6d58f6e3fcf7e7988cb5fc1c61de7/src/lib/V2DutchOrderLib.sol#L20"},"CosignerData"),".  "),(0,i.kt)("li",{parentName:"ul"},"If the price moves outside the signed parameters, the order fails, and the user must try again.  "))),(0,i.kt)("li",{parentName:"ol"},"The finalized order containing CosignerData is posted to the filler network for execution.  "),(0,i.kt)("li",{parentName:"ol"},"The winning filler executes the order.")),(0,i.kt)("h2",{id:"why-is-a-cosigner-needed"},"Why is a cosigner needed?"),(0,i.kt)("p",null,"In UniswapX V2, users commit to a range of prices when signing their order. Without safeguards, a malicious auctioneer could provide users the worst price within their range."),(0,i.kt)("p",{align:"center"},(0,i.kt)("img",{width:"599",alt:"image",src:r(53633).Z})),(0,i.kt)("p",null,"The cosigner field allows users to designate an auctioneer they trust to run the auction fairly, ensuring the best executable price within the signed parameters. Currently, the trading API sets the cosigner to Uniswap Labs, though this could be updated in the future."),(0,i.kt)("h1",{id:"current-status"},"Current Status"),(0,i.kt)("p",null,"UniswapX V2 is currently the default version of the protocol running on Mainnet across Uniswap's interfaces."),(0,i.kt)("h1",{id:"smart-contracts"},"Smart Contracts"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Uniswap/UniswapX/blob/main/src/reactors/V2DutchOrderReactor.sol"},"V2DutchOrderReactor"))))}p.isMDXComponent=!0},3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>h});var n=r(67294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(r),h=i,m=d["".concat(c,".").concat(h)]||d[h]||p[h]||a;return r?n.createElement(m,o(o({ref:t},u),{},{components:r})):n.createElement(m,o({ref:t},u))}));function h(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,o=new Array(a);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var l=2;l<a;l++)o[l]=r[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},53633:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/cosigner-38a7de719736b3c6a9eabb0f05091c7e.png"},31148:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/v1-flow-c19ebe2f784563f62c47cab02cd10cfe.png"},5379:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/v2-flow-1c31af9e8e1c805e48a4ee0f1b51ab32.png"}}]);