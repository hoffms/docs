"use strict";(self.webpackChunk_uniswap_docs=self.webpackChunk_uniswap_docs||[]).push([[64208],{44385:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(83117),o=(n(67294),n(3905));const i={id:"overview",title:"Overview",sidebar_position:1},r="Uniswap v4",s={unversionedId:"contracts/v4/overview",id:"contracts/v4/overview",title:"Overview",description:"Uniswap v4 inherits all of the capital efficiency gains of Uniswap v3, but provides flexibility via hooks and gas optimizations across the entire lifecycle.",source:"@site/docs/contracts/v4/overview.mdx",sourceDirName:"contracts/v4",slug:"/contracts/v4/overview",permalink:"/docs/contracts/v4/overview",editUrl:"https://github.com/uniswap/uniswap-docs/tree/main/docs/contracts/v4/overview.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"overview",title:"Overview",sidebar_position:1},sidebar:"contractsSidebar",next:{title:"Deployments",permalink:"/docs/contracts/v4/deployments"}},l={},c=[{value:"Hooks",id:"hooks",level:2},{value:"Dynamic Fees",id:"dynamic-fees",level:2},{value:"Singleton Design",id:"singleton-design",level:2},{value:"Flash Accounting",id:"flash-accounting",level:2},{value:"Native ETH",id:"native-eth",level:2},{value:"Custom Accounting",id:"custom-accounting",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"uniswap-v4"},"Uniswap v4"),(0,o.kt)("p",null,"Uniswap v4 inherits all of the capital efficiency gains of Uniswap v3, but provides flexibility via ",(0,o.kt)("em",{parentName:"p"},"hooks")," and gas optimizations across the entire lifecycle."),(0,o.kt)("p",null,"For additional information, see the ",(0,o.kt)("a",{parentName:"p",href:"https://app.uniswap.org/whitepaper-v4.pdf"},"Uniswap v4 whitepaper")),(0,o.kt)("h2",{id:"hooks"},"Hooks"),(0,o.kt)("p",null,"Developers can attach solidity logic to the ",(0,o.kt)("em",{parentName:"p"},"swap lifecycle")," through Hooks. The logic is executed before and/or after major operations such as\npool creation, liquidity addition and removal, swapping, and donations. Hooks are deployed contracts, and are called by the Uniswap v4 PoolManager,\nfor permissionless execution."),(0,o.kt)("p",null,"The flexibility of hooks can enable: "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Limit orders"),(0,o.kt)("li",{parentName:"ul"},"Custom oracles"),(0,o.kt)("li",{parentName:"ul"},"Fee management"),(0,o.kt)("li",{parentName:"ul"},"Automated liquidity management")),(0,o.kt)("h2",{id:"dynamic-fees"},"Dynamic Fees"),(0,o.kt)("p",null,"Uniswap v4 supports dynamic fees, allowing pools to adjust their fees up or down. While other AMMs may have hard-coded logic for dynamic fees,\nv4 provides no opinionated calculation of the fee. The frequency of ",(0,o.kt)("em",{parentName:"p"},"liquidity fee")," updates is also flexible and determined by the developer. Fee updates can\noccur on every swap, every block, or on an arbitrary schedule (weekly, monthly, yearly, etc)."),(0,o.kt)("p",null,"Dynamic fees open up the design space for fee optimization, value redistribution, and research."),(0,o.kt)("h2",{id:"singleton-design"},"Singleton Design"),(0,o.kt)("p",null,"Architecturally, all pool state and operations are managed by a single contract -- ",(0,o.kt)("inlineCode",{parentName:"p"},"PoolManager.sol"),". The singleton design provides major gas\nsavings. For example, creating a pool is now a state update instead of the deployment of a new contract. Swapping through multiple pools no longer requires\ntransferring tokens for intermediate pools."),(0,o.kt)("h2",{id:"flash-accounting"},"Flash Accounting"),(0,o.kt)("p",null,"By leveraging EIP-1153 Transient Storage, v4 provides an optimization referred to as ",(0,o.kt)("em",{parentName:"p"},"flash accounting"),". Swapping, liquidity modification, and donations\nincur ",(0,o.kt)("em",{parentName:"p"},"balance changes"),", i.e. tokens to be sent in and tokens to be taken out. With ",(0,o.kt)("em",{parentName:"p"},"flash accounting")," these balance changes are efficiently recorded in transient storage and\nnetted against each other. This system allows users to only pay the final balance change, without the need for resolving intermediate balance changes."),(0,o.kt)("h2",{id:"native-eth"},"Native ETH"),(0,o.kt)("p",null,"Uniswap v4 supports native token assets (Ether), without the need to wrap/unwrap the native token to Wrapped Ether (WETH9)."),(0,o.kt)("h2",{id:"custom-accounting"},"Custom Accounting"),(0,o.kt)("p",null,"The flexibility of custom accounting allows developers to alter token amounts for swaps and liquidity modifications. The feature opens up the design\nspace for hooks to charge fees or forgo the underlying concentrated liquidity model."),(0,o.kt)("p",null,"Example use-cases:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Custom curves, opt-out of the concentrated liquidity curve in favor of an entirely independent pricing mechanism"),(0,o.kt)("li",{parentName:"ul"},"Hook swap fees, charge and collect fees on swaps"),(0,o.kt)("li",{parentName:"ul"},"Liquidity withdrawal fees, penalize and/or redistribute fee revenue")))}u.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),f=o,v=d["".concat(l,".").concat(f)]||d[f]||u[f]||i;return n?a.createElement(v,r(r({ref:t},p),{},{components:n})):a.createElement(v,r({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var c=2;c<i;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);