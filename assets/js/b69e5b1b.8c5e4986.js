"use strict";(self.webpackChunk_uniswap_docs=self.webpackChunk_uniswap_docs||[]).push([[57538],{7914:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>n,metadata:()=>s,toc:()=>p});var i=t(83117),a=(t(67294),t(3905));const n={id:"priorityorderreactor",title:"Priority Order Reactor",sidebar_position:6},o="What is the Priority Order Reactor?",s={unversionedId:"contracts/uniswapx/guides/priority/priorityorderreactor",id:"contracts/uniswapx/guides/priority/priorityorderreactor",title:"Priority Order Reactor",description:"The Priority Order Reactor is a new, experimental UniswapX reactor built specifically for optimal execution chains that utilize Priority Gas Auctions (PGA) for ordering transactions. This new reactor type, which is based on research presented in Priority is All you Need, allows fillers to bid on orders during fulfillment through setting custom priority fees.",source:"@site/docs/contracts/uniswapx/guides/priority/priorityorderreactor.md",sourceDirName:"contracts/uniswapx/guides/priority",slug:"/contracts/uniswapx/guides/priority/priorityorderreactor",permalink:"/docs/contracts/uniswapx/guides/priority/priorityorderreactor",editUrl:"https://github.com/uniswap/uniswap-docs/tree/main/docs/contracts/uniswapx/guides/priority/priorityorderreactor.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{id:"priorityorderreactor",title:"Priority Order Reactor",sidebar_position:6},sidebar:"contractsSidebar",previous:{title:"Filling on Arbitrum",permalink:"/docs/contracts/uniswapx/guides/arbitrum/arbitrumfiller"},next:{title:"Webhook Support",permalink:"/docs/contracts/uniswapx/guides/webhooks"}},l={},p=[{value:"Example Implementation",id:"example-implementation",level:2},{value:"Retrieving and Executing Signed Orders",id:"retrieving-and-executing-signed-orders",level:2},{value:"Parsing an order",id:"parsing-an-order",level:3},{value:"Executing an order",id:"executing-an-order",level:2}],c={toc:p};function d(e){let{components:r,...t}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"what-is-the-priority-order-reactor"},"What is the Priority Order Reactor?"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Uniswap/UniswapX/blob/main/src/reactors/PriorityOrderReactor.sol"},"Priority Order Reactor")," is a new, experimental UniswapX reactor built specifically for optimal execution chains that utilize Priority Gas Auctions (PGA) for ordering transactions. This new reactor type, which is based on research presented in ",(0,a.kt)("a",{parentName:"p",href:"https://www.paradigm.xyz/2024/06/priority-is-all-you-need"},"Priority is All you Need"),", allows fillers to bid on orders during fulfillment through setting custom priority fees. "),(0,a.kt)("h2",{id:"example-implementation"},"Example Implementation"),(0,a.kt)("p",null,"Alice submits a PriorityOrder offering 1 ETH in exchange for a minimum of 1000 USDC. The fair market rate for the order is 1100 USDC, resulting in around 100 USDC in potential profit. "),(0,a.kt)("p",null,"If we assume a filler has a desired margin of 10% of the total profit, the best price is 1090 USDC. This would be 900 bps of improvement. This filler would convert bps to mps (see below for details) to get 900 * 1000 = 900,000 mps of improvement. Thus they would set priorityFee of 900,000 wei on their fill transaction. Keep in mind that this is additional to the base fee."),(0,a.kt)("h1",{id:"important-considerations"},"Important considerations"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The PriorityOrderReactor is only meant to be used on chains which order transactions by priority fee. "),(0,a.kt)("li",{parentName:"ul"},"We do not plan to run any preliminary auctions for the start price of these orders, rather we set a minimum price that each order must be executed at."),(0,a.kt)("li",{parentName:"ul"},"Each order is only executable after a certain block specified by the user. This block will be a few blocks in the future from when the order is made available through the UniswapX orders endpoint. To ensure the best UX for our users, Uniswap Labs has the ability to make the start block earlier by cosigning the order."),(0,a.kt)("li",{parentName:"ul"},"Only the fill transaction with the highest priority fee will win the order, all other transactions will revert on chain."),(0,a.kt)("li",{parentName:"ul"},"To minimize the gas used on reverting transactions, we revert early if the order is already filled or is not fillable yet."),(0,a.kt)("li",{parentName:"ul"},"For every wei of priority fee above a certain threshold (an optional value specified in the order), the user is owed 1 milli-bps more of their output token (or less of their input token). "),(0,a.kt)("li",{parentName:"ul"},"Milli-bps (or MPS) are one-thousandth of a basis point.")),(0,a.kt)("h2",{id:"retrieving-and-executing-signed-orders"},"Retrieving and Executing Signed Orders"),(0,a.kt)("p",null,"All signed Priority Orders created through the Uniswap UI will be available via the UniswapX Orders Endpoint. We have ",(0,a.kt)("a",{parentName:"p",href:"https://api.uniswap.org/v2/uniswapx/docs"},"swagger documentation")," but see below for a quick example curl."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"GET https://api.uniswap.org/v2/orders?orderStatus=open&chainId=8453&orderType=Priority\n")),(0,a.kt)("p",null,"As a lower latency alternative to polling the API, fillers can also apply to register a webhook and receive a feed of all open orders. See details for registering ",(0,a.kt)("a",{parentName:"p",href:"../webhooks"},"here"),". "),(0,a.kt)("p",null,"After fetching orders, use the latest version of the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Uniswap/sdks/tree/main/sdks/uniswapx-sdk#parsing-orders"},"UniswapX SDK"),". Requires ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@uniswap/uniswapx-sdk/v/2.1.0-beta.13"},"2.1.0-beta.13")," or later."),(0,a.kt)("h3",{id:"parsing-an-order"},"Parsing an order"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import { CosignedPriorityOrder, Order } from '@uniswap/uniswapx-sdk';\n\nconst serializedOrder = '0x1111222233334444555500000000234300234...';\nconst chainId = 1; \n\nconst order: Order = CosignedPriorityOrder.parse(serializedOrder, chainId);\n\nconst orderData = order.info;\nconst orderHash = order.hash();\n")),(0,a.kt)("p",null,"The existing ",(0,a.kt)("inlineCode",{parentName:"p"},"UniswapXOrderQuoter")," can also be used to quote priority orders, however, you must use an JsonRpcProvider which supports block overrides. Without block overrides, the SDK quoter cannot validate the entire order as the block number is checked first in the contract."),(0,a.kt)("h2",{id:"executing-an-order"},"Executing an order"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Uniswap/UniswapX/blob/main/src/reactors/PriorityOrderReactor.sol"},"PriorityOrderReactor")," shares the same interface as all other existing UniswapX reactors. Orders are executed against the ",(0,a.kt)("inlineCode",{parentName:"p"},"execute")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"executeBatch")," functions, and optionally a callback is available via ",(0,a.kt)("inlineCode",{parentName:"p"},"executeWithCallback")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"executeBatchWithCallback"),"."),(0,a.kt)("h1",{id:"deployment-addresses"},"Deployment addresses"),(0,a.kt)("p",null,"The PriorityOrderReactor is deployed on the following chains:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Chain"),(0,a.kt)("th",{parentName:"tr",align:null},"Source"),(0,a.kt)("th",{parentName:"tr",align:null},"Address"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Unichain"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://github.com/Uniswap/UniswapX/blob/main/src/reactors/PriorityOrderReactor.sol"},"PriorityOrderReactor")),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://uniscan.xyz/address/0x00000006021a6Bce796be7ba509BBBA71e956e37"},"0x00000006021a6Bce796be7ba509BBBA71e956e37"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Base"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://github.com/Uniswap/UniswapX/blob/main/src/reactors/PriorityOrderReactor.sol"},"PriorityOrderReactor")),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://basescan.org/address/0x000000001Ec5656dcdB24D90DFa42742738De729"},"0x000000001Ec5656dcdB24D90DFa42742738De729"))))),(0,a.kt)("h1",{id:"timeline"},"Timeline"),(0,a.kt)("p",null,"The Priority Order Reactor has been live on Base since August 2024 and is now live on Unichain. Join the ",(0,a.kt)("a",{parentName:"p",href:"https://t.me/UniswapXdiscussion"},"UniswapX Fillers Channel")," for more details."))}d.isMDXComponent=!0},3905:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>h});var i=t(67294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?n(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,i,a=function(e,r){if(null==e)return{};var t,i,a={},n=Object.keys(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=i.createContext({}),p=function(e){var r=i.useContext(l),t=r;return e&&(t="function"==typeof e?e(r):o(o({},r),e)),t},c=function(e){var r=p(e.components);return i.createElement(l.Provider,{value:r},e.children)},d={inlineCode:"code",wrapper:function(e){var r=e.children;return i.createElement(i.Fragment,{},r)}},u=i.forwardRef((function(e,r){var t=e.components,a=e.mdxType,n=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(t),h=a,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||n;return t?i.createElement(m,o(o({ref:r},c),{},{components:t})):i.createElement(m,o({ref:r},c))}));function h(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var n=t.length,o=new Array(n);o[0]=u;var s={};for(var l in r)hasOwnProperty.call(r,l)&&(s[l]=r[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var p=2;p<n;p++)o[p]=t[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"}}]);